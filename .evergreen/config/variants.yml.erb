buildvariants:
- matrix_name: "ruby-3.2"
  matrix_spec:
    ruby: ["ruby-3.2"]
    driver: ["current"]
    topology: '*'
    mongodb-version: ['6.0']
    os: debian11
  display_name: "${ruby}, ${driver}, ${mongodb-version}, ${topology}"
  tasks:
    - name: "test"

- matrix_name: "mongodb-latest"
  matrix_spec:
    ruby: ["ruby-3.2"]
    driver: ["current"]
    topology: '*'
    mongodb-version: ['latest']
    os: debian11
  display_name: "${ruby}, ${driver}, ${mongodb-version}, ${topology}"
  tasks:
    - name: "test"

- matrix_name: "ruby-3.1"
  matrix_spec:
    ruby: ["ruby-3.1"]
    driver: ["current"]
    topology: '*'
    mongodb-version: ['6.0']
    os: ubuntu-22.04
  display_name: "${ruby}, ${driver}, ${mongodb-version}, ${topology}"
  tasks:
    - name: "test"

- matrix_name: "ruby-3.0"
  matrix_spec:
    ruby: ["ruby-3.0"]
    driver: ["current"]
    topology: ['replica-set']
    mongodb-version: ['5.0']
    os: rhel80
  display_name: "${ruby}, ${driver}, ${mongodb-version}, ${topology}"
  tasks:
    - name: "test"

- matrix_name: "jruby"
  matrix_spec:
    jruby: ["jruby-9.3"]
    driver: ["current"]
    topology: ['replica-set', 'sharded-cluster']
    mongodb-version: '5.0'
    os: rhel80
  display_name: "${jruby}, ${driver}, ${mongodb-version}, ${topology}"
  tasks:
    - name: "test"

- matrix_name: "ruby-2.7"
  matrix_spec:
    ruby: ["ruby-2.7"]
    driver: ["current"]
    topology: '*'
    mongodb-version: ['4.4']
    os: rhel80
  display_name: "${ruby}, ${driver}, ${mongodb-version}, ${topology}"
  tasks:
    - name: "test"

- matrix_name: "ruby-2.6"
  matrix_spec:
    ruby: ["ruby-2.6"]
    driver: ["current"]
    topology: ['replica-set']
    mongodb-version: ['4.0']
    os: rhel80
  display_name: "${ruby}, ${driver}, ${mongodb-version}, ${topology}"
  tasks:
    - name: "test"

- matrix_name: "driver-upcoming"
  matrix_spec:
    driver: [master, stable]
    ruby: ["ruby-3.2"]
    mongodb-version: "6.0"
    topology: ['replica-set', 'sharded-cluster']
    os: debian11
  display_name: "${ruby}, ${driver}, ${mongodb-version}, ${topology}"
  tasks:
     - name: "test"

- matrix_name: "driver-oldstable"
  matrix_spec:
    driver: [oldstable, min]
    ruby: ["ruby-2.6"]
    mongodb-version: "4.0"
    topology: ['replica-set', 'sharded-cluster']
    os: rhel80
  display_name: "${ruby}, ${driver}, ${mongodb-version}, ${topology}"
  tasks:
     - name: "test"

- matrix_name: "driver-min"
  matrix_spec:
    driver: [min]
    ruby: ["ruby-2.6"]
    mongodb-version: "3.6"
    topology: "standalone"
    os: rhel80
  display_name: "${ruby}, ${driver}, ${mongodb-version}, ${topology}"
  tasks:
     - name: "test"

- matrix_name: "rails-7"
  matrix_spec:
    ruby: ["ruby-3.2"]
    driver: ["current"]
    mongodb-version: "6.0"
    topology: "standalone"
    rails: ['7.0']
    os: debian11
  display_name: "${rails}, ${driver}, ${mongodb-version}"
  tasks:
    - name: "test"

- matrix_name: "bson-min"
  matrix_spec:
    driver: [bson-min]
    ruby: ["ruby-2.7"]
    mongodb-version: "5.0"
    topology: "standalone"
    os: rhel80
  display_name: "${ruby}, ${driver}, ${mongodb-version}, ${topology}"
  tasks:
    - name: "test"

- matrix_name: "bson-master"
  matrix_spec:
    driver: [bson-master]
    ruby: ["ruby-3.0"]
    mongodb-version: "5.0"
    topology: "standalone"
    os: rhel80
  display_name: "${ruby}, ${driver}, ${mongodb-version}, ${topology}"
  tasks:
    - name: "test"


- matrix_name: "rails-6"
  matrix_spec:
    ruby: ["ruby-3.0"]
    driver: ["current"]
    mongodb-version: "6.0"
    topology: "standalone"
    rails: ['6.0', '6.1']
    os: rhel80
  display_name: "${rails}, ${driver}, ${mongodb-version}"
  tasks:
     - name: "test"

- matrix_name: "rails-5"
  matrix_spec:
    ruby: ["ruby-2.7"]
    driver: ["current"]
    mongodb-version: "4.0"
    topology: "standalone"
    rails: ['5.2']
    os: rhel80
  display_name: "${rails}, ${driver}, ${mongodb-version}"
  tasks:
     - name: "test"

- matrix_name: "i18n-1.0"
  matrix_spec:
    ruby: "ruby-2.6"
    driver: ["current"]
    mongodb-version: "4.4"
    topology: "standalone"
    i18n: '1.0'
    os: rhel80
  display_name: "i18n-1.0 ${rails}, ${driver}, ${mongodb-version}"
  tasks:
     - name: "test"

- matrix_name: "i18n-fallbacks"
  matrix_spec:
    ruby: "ruby-2.6"
    driver: ["current"]
    mongodb-version: "4.2"
    topology: "standalone"
    i18n: '*'
    test-i18n-fallbacks: yes
    os: rhel80
  display_name: "i18n fallbacks ${rails}, ${driver}, ${mongodb-version}, ${i18n}"
  tasks:
     - name: "test"

- matrix_name: app-tests-ruby-3
  matrix_spec:
    ruby: ["ruby-3.0", "ruby-3.1", "ruby-3.2"]
    driver: ["current"]
    mongodb-version: '6.0'
    topology: standalone
    app-tests: yes
    rails: ['6.0', '6.1', '7.0']
    os: rhel80
  display_name: "app tests ${driver}, ${ruby}, ${rails}"
  tasks:
    - name: "test"

- matrix_name: app-tests-ruby-2.7
  matrix_spec:
    ruby: ruby-2.7
    driver: ["current"]
    mongodb-version: '5.0'
    topology: standalone
    app-tests: yes
    rails: ['5.2']
    os: rhel80
  display_name: "app tests ${driver}, ${ruby}, ${rails}"
  tasks:
     - name: "test"

- matrix_name: app-tests-jruby
  matrix_spec:
    jruby: ["jruby-9.3"]
    driver: ["current"]
    mongodb-version: '5.0'
    topology: standalone
    app-tests: yes
    rails: ['6.0']
    os: ubuntu-18.04
  display_name: "app tests ${driver}, ${jruby}"
  tasks:
     - name: "test"

- matrix_name: "auto-encryption"
  matrix_spec:
    ruby: ruby-3.1
    driver: current
    topology: replica-set
    mongodb-version: ['6.0']
    os: ubuntu-22.04
    rails: ['7.0']
    fle: helper
  display_name: "FLE: ${rails}, ${driver}, ${mongodb-version}"
  tasks:
    - name: "test"
